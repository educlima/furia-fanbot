// Base de conhecimento atualizada sobre a FURIA Esports
export const furiaKnowledgeBase = {
  // Informações gerais sobre a organização
  organization: {
    name: "FURIA Esports",
    foundedYear: 2017,
    founders: ["Jaime 'raizen' Pádua", "André Akkari"],
    headquarters: "São Paulo, Brasil",
    slogan: ["Driven by Instinct", "Build to Dominate"],
    website: "https://furia.gg",
    shop: "https://shop.furia.gg",
    socialMedia: {
      twitter: "https://twitter.com/FURIA",
      instagram: "https://instagram.com/furiagg",
      youtube: "https://youtube.com/furiagg",
      twitch: "https://twitch.tv/furiatv",
    },
  },

  // Informações atualizadas sobre o time de CS:GO
  csgo: {
    currentRoster: [
      {
        name: "Caído (Gabriel Toledo)",
        nickname: "Caído",
        role: "Jogador",
        nationality: "Brasil",
        joinDate: "2023",
        description:
          "Gabriel 'Caído' Toledo é um dos jogadores mais icônicos do CS:GO brasileiro, tendo liderado a SK Gaming/MIBR para dois títulos de Major. Agora defende as cores da FURIA.",
        signature: "Liderança e experiência em grandes competições",
      },
      {
        name: "Yuri 'yuurih' Santos",
        nickname: "yuurih",
        role: "Rifler/Support",
        nationality: "Brasil",
        joinDate: "2018",
        achievements: ["Top 20 jogadores do mundo pela HLTV"],
        description:
          "Jogador versátil e consistente, yuurih é fundamental para o sucesso da equipe. Sua capacidade de se adaptar a diferentes funções e mapas o torna um jogador completo.",
        signature: "Versatilidade e consistência em diferentes mapas",
      },
      {
        name: "Kaike 'KSCERATO' Cerato",
        nickname: "KSCERATO",
        role: "Rifler",
        nationality: "Brasil",
        joinDate: "2019",
        achievements: ["Top 20 jogadores do mundo pela HLTV em 2020 e 2021"],
        description:
          "Um dos melhores jogadores do Brasil, KSCERATO é conhecido por sua precisão e consistência. Sua capacidade de acertar headshots e manter a calma em situações de pressão o torna um dos pilares da equipe.",
        signature: "Precisão com rifles e clutches em situações de 1vX",
      },
      {
        name: "Mareks 'YEKINDAR' Gaļinskis",
        nickname: "YEKINDAR",
        role: "Entry Fragger",
        nationality: "Letônia",
        joinDate: "2023",
        description:
          "YEKINDAR é um jogador letão conhecido por seu estilo agressivo como entry fragger. Anteriormente jogou pela Virtus.pro e Team Liquid antes de se juntar à FURIA.",
        signature: "Agressividade e criação de espaço para a equipe",
      },
      {
        name: "Danil 'Molodoy' Golubenko",
        nickname: "Molodoy",
        role: "Jogador",
        nationality: "Cazaquistão",
        joinDate: "2023",
        description:
          "Jovem talento do Cazaquistão que se juntou recentemente à FURIA, trazendo uma nova dimensão para o jogo da equipe.",
        signature: "Talento jovem com grande potencial",
      },
      {
        name: "Marcelo 'chelo' Céspedes",
        nickname: "chelo",
        role: "Rifler (Inativo)",
        nationality: "Brasil",
        joinDate: "2021",
        description:
          "Jogador brasileiro atualmente inativo no elenco da FURIA. Conhecido por sua consistência e habilidade com rifles.",
        signature: "Jogador versátil com bom controle de spray",
      },
      {
        name: "Felipe 'caveiras' Medeiros",
        nickname: "caveiras",
        role: "Jogador",
        nationality: "Brasil",
        joinDate: "2023",
        description:
          "Jogador brasileiro que faz parte do elenco da FURIA CS:GO, trazendo novas perspectivas para a equipe.",
        signature: "Adaptabilidade e trabalho em equipe",
      },
    ],
    coach: {
      name: "Sid 'Sidde' Macedo",
      role: "Treinador Principal",
      nationality: "Brasil",
      joinDate: "2023",
      description:
        "Sidde é o atual treinador principal da FURIA CS:GO, responsável pela estratégia e desenvolvimento da equipe.",
    },
    formerPlayers: [
      "Andrei 'arT' Piovezan",
      "Rafael 'saffee' Costa",
      "André 'drop' Abreu",
      "Vinicius 'VINI' Figueiredo",
      "Henrique 'HEN1' Teles",
      "Lucas 'honda' Cano",
    ],
    achievements: [
      {
        title: "Top 8 no PGL Major Stockholm 2021",
        date: "Novembro 2021",
        description:
          "A FURIA alcançou as quartas de final do Major de Estocolmo, consolidando sua posição entre as melhores equipes do mundo.",
      },
      {
        title: "Vice-campeão da ESL Pro League Season 12",
        date: "Outubro 2020",
        description:
          "A equipe chegou à final da ESL Pro League Season 12, perdendo apenas para a Astralis na grande final.",
      },
      {
        title: "Campeão da BLAST Premier Spring Showdown 2023",
        date: "Abril 2023",
        description: "A FURIA venceu a BLAST Premier Spring Showdown 2023, garantindo vaga na Spring Final.",
      },
      {
        title: "Top 5 do Ranking Mundial HLTV",
        date: "2020",
        description:
          "A FURIA alcançou o Top 5 do ranking mundial da HLTV, o mais alto já alcançado por uma equipe brasileira.",
      },
    ],
    playstyle:
      "A FURIA está passando por uma fase de transição com seu novo elenco, adaptando seu estilo de jogo para incorporar a experiência de Caído e o estilo agressivo de YEKINDAR, mantendo elementos do estilo brasileiro que a caracterizou nos últimos anos.",
    maps: [
      {
        name: "Nuke",
        status: "Forte",
        description: "Um dos mapas mais fortes da FURIA, com estratégias únicas no lado CT e T.",
      },
      {
        name: "Vertigo",
        status: "Forte",
        description: "A FURIA desenvolveu um estilo próprio neste mapa, tornando-se uma de suas escolhas preferidas.",
      },
      {
        name: "Inferno",
        status: "Competitivo",
        description: "Um mapa sólido para a equipe, com boas execuções no lado terrorista.",
      },
      {
        name: "Mirage",
        status: "Competitivo",
        description: "Mapa tradicional onde a FURIA costuma ter bom desempenho.",
      },
      {
        name: "Ancient",
        status: "Em desenvolvimento",
        description: "Mapa mais recente onde a equipe tem trabalhado para melhorar seu desempenho.",
      },
    ],
  },

  // Informações atualizadas sobre o time de VALORANT
  valorant: {
    currentRoster: [
      {
        name: "Khalil 'khalil' Schmidt",
        nickname: "khalil",
        role: "Jogador",
        nationality: "Brasil",
        joinDate: "2022",
        description: "Jogador brasileiro de VALORANT que representa a FURIA nas competições.",
        signature: "Habilidade com agentes de duelo",
      },
      {
        name: "Leonardo 'mwzera' Serrati",
        nickname: "mwzera",
        role: "Jogador",
        nationality: "Brasil",
        joinDate: "2022",
        description: "Um dos jogadores mais talentosos do VALORANT brasileiro, conhecido por suas jogadas de impacto.",
        signature: "Agressividade e mecânica refinada",
      },
      {
        name: "Ilan 'estragos' Eloy",
        nickname: "estragos",
        role: "Jogador",
        nationality: "Brasil",
        joinDate: "2022",
        description: "Jogador versátil que se adaptou bem ao estilo da FURIA no VALORANT.",
        signature: "Versatilidade com diferentes agentes",
      },
      {
        name: "Olavo 'aquecer' Marcelo",
        nickname: "aquecer",
        role: "Jogador",
        nationality: "Brasil",
        joinDate: "2022",
        description: "Jogador brasileiro que contribui para o sucesso da equipe de VALORANT da FURIA.",
        signature: "Suporte sólido para a equipe",
      },
      {
        name: "Rafael 'raafa' Lima",
        nickname: "raafa",
        role: "Jogador",
        nationality: "Brasil",
        joinDate: "2022",
        description: "Jogador brasileiro que completa o elenco atual de VALORANT da FURIA.",
        signature: "Comunicação e trabalho em equipe",
      },
    ],
    coach: {
      name: "Pedro 'peu' Lopes",
      role: "Treinador Principal",
      nationality: "Brasil",
      joinDate: "2022",
      description:
        "Treinador principal da equipe de VALORANT da FURIA, responsável pela estratégia e desenvolvimento dos jogadores.",
    },
    assistantCoach: {
      name: "Lucas 'lukzera' Soares",
      role: "Treinador Assistente",
      nationality: "Brasil",
      joinDate: "2022",
      description: "Treinador assistente que auxilia na preparação e desenvolvimento da equipe de VALORANT da FURIA.",
    },
    achievements: [
      "Classificação para o VCT Americas",
      "Top 3 em torneios regionais",
      "Participação em competições internacionais representando o Brasil",
    ],
  },

  // Informações atualizadas sobre o time de League of Legends
  lol: {
    currentRoster: [
      {
        name: "Guilherme 'Guigo' Ruiz",
        nickname: "Guigo",
        role: "Jogador",
        nationality: "Brasil",
        joinDate: "2022",
        description: "Jogador brasileiro de League of Legends que representa a FURIA no CBLOL.",
        signature: "Experiência em competições nacionais",
      },
      {
        name: "Pedro 'Tatu' Seixas",
        nickname: "Tatu",
        role: "Jogador",
        nationality: "Brasil",
        joinDate: "2022",
        description: "Jogador brasileiro que faz parte do elenco atual de LoL da FURIA.",
        signature: "Adaptabilidade a diferentes campeões",
      },
      {
        name: "Arthur 'Tutsz' Peixoto Machado",
        nickname: "Tutsz",
        role: "Jogador",
        nationality: "Brasil",
        joinDate: "2022",
        description: "Jogador brasileiro de League of Legends da FURIA que compete no CBLOL.",
        signature: "Mecânica sólida e tomada de decisões",
      },
      {
        name: "Andrey 'Ayu' Saraiva",
        nickname: "Ayu",
        role: "Jogador",
        nationality: "Brasil",
        joinDate: "2022",
        description: "Jogador brasileiro que contribui para o desempenho da equipe de LoL da FURIA.",
        signature: "Comunicação e visão de jogo",
      },
      {
        name: "Gabriel 'JoJo' Dzelme de Oliveira",
        nickname: "JoJo",
        role: "Jogador",
        nationality: "Brasil",
        joinDate: "2022",
        description: "Jogador brasileiro que completa o elenco atual de League of Legends da FURIA.",
        signature: "Versatilidade e trabalho em equipe",
      },
    ],
    coach: {
      name: "Thomas 'Thinkcard' Slotkin",
      role: "Treinador Principal",
      nationality: "Estados Unidos",
      joinDate: "2022",
      description:
        "Treinador principal da equipe de League of Legends da FURIA, trazendo experiência internacional para o time brasileiro.",
    },
    achievements: [
      "Participação no CBLOL",
      "Desenvolvimento de talentos brasileiros",
      "Evolução constante no cenário competitivo nacional",
    ],
  },

  // Próximos jogos (exemplo)
  upcomingMatches: [
    {
      opponent: "Team Liquid",
      event: "ESL Pro League Season 19",
      date: "15/05/2025",
      time: "15:00",
      game: "CS:GO",
    },
    {
      opponent: "NAVI",
      event: "BLAST Premier Spring Finals",
      date: "20/05/2025",
      time: "13:30",
      game: "CS:GO",
    },
    {
      opponent: "Sentinels",
      event: "VCT Americas",
      date: "18/05/2025",
      time: "19:00",
      game: "VALORANT",
    },
  ],

  // Resultados recentes (exemplo)
  recentResults: [
    {
      opponent: "Cloud9",
      result: "Vitória (16-12, 16-14)",
      event: "ESL Pro League",
      date: "05/05/2025",
      game: "CS:GO",
    },
    {
      opponent: "FaZe Clan",
      result: "Derrota (13-16, 10-16)",
      event: "BLAST Premier",
      date: "01/05/2025",
      game: "CS:GO",
    },
    {
      opponent: "100 Thieves",
      result: "Vitória (13-7, 13-10)",
      event: "VCT Americas",
      date: "03/05/2025",
      game: "VALORANT",
    },
  ],

  // FAQ sobre a FURIA
  faq: [
    {
      question: "Quando a FURIA foi fundada?",
      answer: "A FURIA Esports foi fundada em 2017 por Jaime 'raizen' Pádua e André Akkari.",
    },
    {
      question: "Quais jogos a FURIA compete atualmente?",
      answer:
        "A FURIA compete em diversos jogos, incluindo CS:GO, VALORANT, League of Legends, Apex Legends, Fortnite, entre outros.",
    },
    {
      question: "Onde posso comprar produtos oficiais da FURIA?",
      answer: "Você pode comprar produtos oficiais da FURIA na loja online oficial: shop.furia.gg",
    },
    {
      question: "Quem faz parte do atual elenco de CS:GO da FURIA?",
      answer:
        "O atual elenco de CS:GO da FURIA inclui Caído (Gabriel Toledo), yuurih (Yuri Santos), KSCERATO (Kaike Cerato), YEKINDAR (Mareks Gaļinskis), Molodoy (Danil Golubenko), com chelo (Marcelo Céspedes) e caveiras (Felipe Medeiros) completando o elenco. O treinador principal é Sid 'Sidde' Macedo.",
    },
    {
      question: "A FURIA já participou de algum Major de CS:GO?",
      answer:
        "Sim, a FURIA já participou de vários Majors de CS:GO, com seu melhor resultado sendo o Top 8 no PGL Major Stockholm 2021.",
    },
    {
      question: "Qual é o estilo de jogo da FURIA no CS:GO?",
      answer:
        "A FURIA está passando por uma fase de transição com seu novo elenco, adaptando seu estilo de jogo para incorporar a experiência de Caído e o estilo agressivo de YEKINDAR, mantendo elementos do estilo brasileiro que a caracterizou nos últimos anos.",
    },
    {
      question: "Quais são os principais rivais da FURIA?",
      answer:
        "No cenário brasileiro, a IMPERIAL e a MIBR são consideradas rivais históricas. No cenário internacional, equipes como Team Liquid, NAVI e FaZe Clan são adversários frequentes em grandes torneios.",
    },
    {
      question: "A FURIA tem uma gaming house?",
      answer:
        "Sim, a FURIA possui uma gaming house em São Paulo, Brasil, onde os jogadores treinam e se preparam para competições.",
    },
    {
      question: "Quem é o treinador do time de VALORANT da FURIA?",
      answer:
        "O treinador principal do time de VALORANT da FURIA é Pedro 'peu' Lopes, com Lucas 'lukzera' Soares como treinador assistente.",
    },
    {
      question: "Quem é o treinador do time de League of Legends da FURIA?",
      answer:
        "O treinador principal do time de League of Legends da FURIA é Thomas 'Thinkcard' Slotkin, um treinador americano que traz experiência internacional para o time brasileiro.",
    },
  ],

  // Glossário de termos de CS:GO para ajudar o chatbot a explicar conceitos
  glossary: {
    "entry fragger": "Jogador responsável por abrir o bomb site, sendo o primeiro a entrar e buscar abates iniciais.",
    awper: "Jogador especializado no uso do rifle de precisão AWP.",
    lurker: "Jogador que se separa da equipe para pegar adversários desprevenidos ou cortar rotações.",
    igl: "In-Game Leader, o líder dentro do jogo responsável por chamar estratégias.",
    clutch: "Situação onde um jogador precisa vencer contra múltiplos adversários sozinho.",
    eco: "Round onde a equipe economiza dinheiro, usando pistolas ou armas baratas.",
    "force buy": "Compra forçada de armas mesmo sem dinheiro suficiente para um full buy.",
    "full buy": "Round onde a equipe compra equipamento completo (rifles, granadas, colete).",
    trade: "Abate de vingança, quando um jogador elimina o adversário que acabou de matar seu companheiro.",
    retake: "Tentativa de recuperar um bomb site após o plant da bomba pelos terroristas.",
  },
}

// Função para buscar informações específicas da base de conhecimento
export function getKnowledgeForPrompt(query: string): string {
  // Converte a query para minúsculas para facilitar a comparação
  const lowerQuery = query.toLowerCase()

  // Array para armazenar as informações relevantes
  const relevantInfo: string[] = []

  // Verifica se a query está relacionada à organização
  if (
    lowerQuery.includes("furia") ||
    lowerQuery.includes("organização") ||
    lowerQuery.includes("fundação") ||
    lowerQuery.includes("fundada") ||
    lowerQuery.includes("história")
  ) {
    const org = furiaKnowledgeBase.organization
    relevantInfo.push(
      `A ${org.name} foi fundada em ${org.foundedYear} por ${org.founders.join(" e ")}.`,
      `Sua sede fica em ${org.headquarters}.`,
      `Seus slogans incluem "${org.slogan[0]}" e "${org.slogan[1]}".`,
    )
  }

  // Verifica se a query está relacionada ao time de CS:GO
  if (
    lowerQuery.includes("cs") ||
    lowerQuery.includes("cs:go") ||
    lowerQuery.includes("csgo") ||
    lowerQuery.includes("counter") ||
    lowerQuery.includes("counter-strike") ||
    lowerQuery.includes("jogadores") ||
    lowerQuery.includes("time") ||
    lowerQuery.includes("elenco") ||
    lowerQuery.includes("roster")
  ) {
    const csgo = furiaKnowledgeBase.csgo

    // Informações gerais sobre o time
    relevantInfo.push("Time de CS:GO da FURIA:", `Coach: ${csgo.coach.name}`, `Estilo de jogo: ${csgo.playstyle}`)

    // Adiciona informações sobre os jogadores
    if (
      lowerQuery.includes("jogadores") ||
      lowerQuery.includes("roster") ||
      lowerQuery.includes("elenco") ||
      lowerQuery.includes("time") ||
      lowerQuery.includes("atual")
    ) {
      relevantInfo.push("Elenco atual de CS:GO da FURIA:")
      csgo.currentRoster.forEach((player) => {
        relevantInfo.push(`${player.name} (${player.nationality}) - ${player.role}: ${player.description}`)
      })
    }

    // Verifica se a query menciona algum jogador específico
    csgo.currentRoster.forEach((player) => {
      const playerNickname = player.nickname.toLowerCase()
      if (lowerQuery.includes(playerNickname)) {
        relevantInfo.push(
          `Sobre ${player.name}:`,
          `Função: ${player.role}`,
          `Nacionalidade: ${player.nationality}`,
          `Na FURIA desde: ${player.joinDate}`,
          player.achievements ? `Conquistas: ${player.achievements.join(", ")}` : "",
          `${player.description}`,
          `Estilo de jogo: ${player.signature}`,
        )
      }
    })

    // Verifica se a query está relacionada a conquistas
    if (
      lowerQuery.includes("conquista") ||
      lowerQuery.includes("título") ||
      lowerQuery.includes("campeonato") ||
      lowerQuery.includes("major") ||
      lowerQuery.includes("torneio")
    ) {
      relevantInfo.push("Principais conquistas da FURIA CS:GO:")
      csgo.achievements.forEach((achievement) => {
        relevantInfo.push(`${achievement.title} (${achievement.date}): ${achievement.description}`)
      })
    }

    // Verifica se a query está relacionada a mapas
    if (
      lowerQuery.includes("mapa") ||
      lowerQuery.includes("dust") ||
      lowerQuery.includes("mirage") ||
      lowerQuery.includes("inferno") ||
      lowerQuery.includes("nuke") ||
      lowerQuery.includes("vertigo") ||
      lowerQuery.includes("ancient")
    ) {
      relevantInfo.push("Mapas da FURIA CS:GO:")
      csgo.maps.forEach((map) => {
        relevantInfo.push(`${map.name} (${map.status}): ${map.description}`)
      })
    }
  }

  // Verifica se a query está relacionada ao time de VALORANT
  if (lowerQuery.includes("valorant") || (lowerQuery.includes("val") && !lowerQuery.includes("valor"))) {
    const valorant = furiaKnowledgeBase.valorant

    relevantInfo.push("Time de VALORANT da FURIA:")

    // Adiciona informações sobre os jogadores
    if (
      lowerQuery.includes("jogadores") ||
      lowerQuery.includes("roster") ||
      lowerQuery.includes("elenco") ||
      lowerQuery.includes("time") ||
      lowerQuery.includes("atual")
    ) {
      relevantInfo.push("Elenco atual de VALORANT da FURIA:")
      valorant.currentRoster.forEach((player) => {
        relevantInfo.push(`${player.name} (${player.nationality}) - ${player.role}: ${player.description}`)
      })

      relevantInfo.push(
        `Treinador Principal: ${valorant.coach.name} (${valorant.coach.nationality})`,
        `Treinador Assistente: ${valorant.assistantCoach.name} (${valorant.assistantCoach.nationality})`,
      )
    }

    // Verifica se a query menciona algum jogador específico
    valorant.currentRoster.forEach((player) => {
      const playerNickname = player.nickname.toLowerCase()
      if (lowerQuery.includes(playerNickname)) {
        relevantInfo.push(
          `Sobre ${player.name}:`,
          `Função: ${player.role}`,
          `Nacionalidade: ${player.nationality}`,
          `Na FURIA desde: ${player.joinDate}`,
          `${player.description}`,
          `Estilo de jogo: ${player.signature}`,
        )
      }
    })

    // Verifica se a query está relacionada a conquistas
    if (
      lowerQuery.includes("conquista") ||
      lowerQuery.includes("título") ||
      lowerQuery.includes("campeonato") ||
      lowerQuery.includes("torneio")
    ) {
      relevantInfo.push("Conquistas da FURIA VALORANT:", valorant.achievements.join("\n"))
    }
  }

  // Verifica se a query está relacionada ao time de League of Legends
  if (lowerQuery.includes("league") || lowerQuery.includes("lol") || lowerQuery.includes("legends")) {
    const lol = furiaKnowledgeBase.lol

    relevantInfo.push("Time de League of Legends da FURIA:")

    // Adiciona informações sobre os jogadores
    if (
      lowerQuery.includes("jogadores") ||
      lowerQuery.includes("roster") ||
      lowerQuery.includes("elenco") ||
      lowerQuery.includes("time") ||
      lowerQuery.includes("atual")
    ) {
      relevantInfo.push("Elenco atual de League of Legends da FURIA:")
      lol.currentRoster.forEach((player) => {
        relevantInfo.push(`${player.name} (${player.nationality}) - ${player.role}: ${player.description}`)
      })

      relevantInfo.push(`Treinador Principal: ${lol.coach.name} (${lol.coach.nationality})`)
    }

    // Verifica se a query menciona algum jogador específico
    lol.currentRoster.forEach((player) => {
      const playerNickname = player.nickname.toLowerCase()
      if (lowerQuery.includes(playerNickname)) {
        relevantInfo.push(
          `Sobre ${player.name}:`,
          `Função: ${player.role}`,
          `Nacionalidade: ${player.nationality}`,
          `Na FURIA desde: ${player.joinDate}`,
          `${player.description}`,
          `Estilo de jogo: ${player.signature}`,
        )
      }
    })

    // Verifica se a query está relacionada a conquistas
    if (
      lowerQuery.includes("conquista") ||
      lowerQuery.includes("título") ||
      lowerQuery.includes("campeonato") ||
      lowerQuery.includes("torneio")
    ) {
      relevantInfo.push("Conquistas da FURIA League of Legends:", lol.achievements.join("\n"))
    }
  }

  // Verifica se a query está relacionada a próximos jogos
  if (
    lowerQuery.includes("próximo") ||
    lowerQuery.includes("jogo") ||
    lowerQuery.includes("partida") ||
    lowerQuery.includes("quando") ||
    lowerQuery.includes("agenda") ||
    lowerQuery.includes("calendário")
  ) {
    relevantInfo.push("Próximos jogos da FURIA:")
    furiaKnowledgeBase.upcomingMatches.forEach((match) => {
      relevantInfo.push(`${match.game}: FURIA vs ${match.opponent} - ${match.event} em ${match.date} às ${match.time}`)
    })
  }

  // Verifica se a query está relacionada a resultados recentes
  if (
    lowerQuery.includes("resultado") ||
    lowerQuery.includes("recente") ||
    lowerQuery.includes("último") ||
    lowerQuery.includes("partida") ||
    lowerQuery.includes("jogo") ||
    lowerQuery.includes("ganhou") ||
    lowerQuery.includes("perdeu")
  ) {
    relevantInfo.push("Resultados recentes da FURIA:")
    furiaKnowledgeBase.recentResults.forEach((result) => {
      relevantInfo.push(
        `${result.game}: FURIA vs ${result.opponent} - ${result.result} (${result.event}, ${result.date})`,
      )
    })
  }

  // Verifica se a query está relacionada a alguma pergunta do FAQ
  for (const faqItem of furiaKnowledgeBase.faq) {
    // Extrai palavras-chave da pergunta
    const keywords = faqItem.question
      .toLowerCase()
      .replace(/[?.,]/g, "")
      .split(" ")
      .filter((word) => word.length > 3)

    // Verifica se a query contém palavras-chave da pergunta
    const hasKeywords = keywords.some((keyword) => lowerQuery.includes(keyword))

    if (hasKeywords) {
      relevantInfo.push(`${faqItem.question}`, `${faqItem.answer}`)
    }
  }

  // Verifica se a query contém termos do glossário
  for (const [term, definition] of Object.entries(furiaKnowledgeBase.glossary)) {
    if (lowerQuery.includes(term)) {
      relevantInfo.push(`${term.toUpperCase()}: ${definition}`)
    }
  }

  // Se não encontrou informações específicas, retorna informações gerais
  if (relevantInfo.length === 0) {
    relevantInfo.push(
      "A FURIA Esports é uma organização brasileira de esports fundada em 2017.",
      "Compete em diversos jogos como CS:GO, VALORANT, League of Legends e Apex Legends.",
      "O time de CS:GO atual inclui Caído, yuurih, KSCERATO, YEKINDAR e Molodoy.",
      "A FURIA é conhecida por revelar talentos brasileiros e competir em torneios internacionais.",
    )
  }

  return relevantInfo.join("\n")
}

// Função para extrair entidades da query do usuário
export function extractEntities(query: string): {
  game?: string
  player?: string
  topic?: string
} {
  const lowerQuery = query.toLowerCase()
  const result: { game?: string; player?: string; topic?: string } = {}

  // Detectar jogo
  if (
    lowerQuery.includes("cs") ||
    lowerQuery.includes("cs:go") ||
    lowerQuery.includes("csgo") ||
    lowerQuery.includes("counter")
  ) {
    result.game = "CS:GO"
  } else if (lowerQuery.includes("valorant") || (lowerQuery.includes("val") && !lowerQuery.includes("valor"))) {
    result.game = "VALORANT"
  } else if (lowerQuery.includes("league") || lowerQuery.includes("lol") || lowerQuery.includes("legends")) {
    result.game = "League of Legends"
  }

  // Detectar jogadores de CS:GO
  const csgoPlayers = ["caído", "yuurih", "kscerato", "yekindar", "molodoy", "chelo", "caveiras"]
  for (const player of csgoPlayers) {
    if (lowerQuery.includes(player)) {
      result.player = player
      if (!result.game) result.game = "CS:GO"
      break
    }
  }

  // Detectar jogadores de VALORANT
  const valorantPlayers = ["khalil", "mwzera", "estragos", "aquecer", "raafa"]
  for (const player of valorantPlayers) {
    if (lowerQuery.includes(player)) {
      result.player = player
      if (!result.game) result.game = "VALORANT"
      break
    }
  }

  // Detectar jogadores de LoL
  const lolPlayers = ["guigo", "tatu", "tutsz", "ayu", "jojo"]
  for (const player of lolPlayers) {
    if (lowerQuery.includes(player)) {
      result.player = player
      if (!result.game) result.game = "League of Legends"
      break
    }
  }

  // Detectar tópico
  if (
    lowerQuery.includes("próximo") ||
    lowerQuery.includes("jogo") ||
    lowerQuery.includes("partida") ||
    lowerQuery.includes("agenda")
  ) {
    result.topic = "próximos jogos"
  } else if (lowerQuery.includes("resultado") || lowerQuery.includes("ganhou") || lowerQuery.includes("perdeu")) {
    result.topic = "resultados"
  } else if (lowerQuery.includes("conquista") || lowerQuery.includes("título") || lowerQuery.includes("campeonato")) {
    result.topic = "conquistas"
  } else if (
    lowerQuery.includes("elenco") ||
    lowerQuery.includes("roster") ||
    lowerQuery.includes("time") ||
    lowerQuery.includes("jogadores")
  ) {
    result.topic = "elenco"
  }

  return result
}

// Função para gerar sugestões de perguntas relacionadas
export function generateRelatedQuestions(query: string): string[] {
  const entities = extractEntities(query)
  const suggestions: string[] = []

  if (entities.game === "CS:GO") {
    suggestions.push("Quem são os jogadores atuais do time de CS:GO da FURIA?")
    suggestions.push("Quais são as principais conquistas da FURIA no CS:GO?")
    if (entities.player) {
      suggestions.push(`Qual é o estilo de jogo do ${entities.player}?`)
      suggestions.push(`Desde quando o ${entities.player} está na FURIA?`)
    }
  } else if (entities.game === "VALORANT") {
    suggestions.push("Quem são os jogadores atuais do time de VALORANT da FURIA?")
    suggestions.push("Quem é o treinador do time de VALORANT da FURIA?")
  } else if (entities.game === "League of Legends") {
    suggestions.push("Quem são os jogadores atuais do time de League of Legends da FURIA?")
    suggestions.push("Em quais competições o time de LoL da FURIA participa?")
  }

  if (entities.topic === "próximos jogos") {
    suggestions.push("Quando será o próximo jogo da FURIA?")
  } else if (entities.topic === "resultados") {
    suggestions.push("Quais foram os últimos resultados da FURIA?")
  } else if (!entities.game && !entities.topic) {
    suggestions.push("Quando a FURIA foi fundada?")
    suggestions.push("Quais modalidades a FURIA compete atualmente?")
    suggestions.push("Quem são os jogadores do time de CS:GO da FURIA?")
  }

  // Limitar a 3 sugestões e garantir que não haja duplicatas
  return [...new Set(suggestions)].slice(0, 3)
}
